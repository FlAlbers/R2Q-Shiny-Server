---
output:
  pdf_document:
    latex_engine: xelatex
    fig_caption: yes
  word_document: default
theme: united
params:
  x: Gruendach
header-includes: 
- \usepackage{tabularx}
- \usepackage{fontspec}
- \setmainfont{Calibri Light}
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{float}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
- \usepackage{threeparttablex}
- \usepackage[normalem]{ulem}
- \usepackage{makecell}
- \usepackage{xcolor}
title: "R2Q Maßnahmenkatalog Test"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r ,echo=FALSE, message=FALSE}
#setwd("C:/R_data/R2Q")
library(readxl)
t1 <- read_excel("R2Q_test.xlsx", 
    sheet = params$X )

```

# `r t1[1,1]`

## *Kurzinformation*

### *Kurzbeschreibung*

`r as.character(t1[1,5])`


### *Umsetzungsbeispiel*



```{r , fig.width = 8 , fig.height = 3 , echo=FALSE, message=FALSE, warning=FALSE}
library(png)
library(grid)
library(gridExtra)
library(kableExtra)
library(knitr)
#jj <- rasterGrob(as.raster(readPNG(as.character(t1[2,6]))), interpolate = FALSE)
#grid.arrange(jj, jj, ncol = 2)
```


```{r , echo=FALSE}

for(i in 3:7){
  if(t1[i,6] == "Ja") {assign(paste("c", i, sep = ""), "X")} else {assign(paste("c", i, sep = ""), " ")}
}

dt <- mtcars[1:5, 1:6]
kable(dt, "latex")
```

\begin{center}
\begin{tabularx}{\textwidth}{|X|X|X|X|X|}
\hline
\multicolumn{5}{|c|}{\textbf{`r t1[1,3]`}} \tabularnewline
\hline
[`r as.character(c3)`] Regenwasser & [`r as.character(c4)`] Schmutzwasser & [`r as.character(c5)`] Baustoffe & [`r as.character(c6)`] Energie & [`r as.character(c7)`] Fläche \\
\hline
\end{tabularx}
\end{center}


```{r , echo=FALSE}
for(i in 8:11){
  if(t1[i,6] == "Ja") {assign(paste("c", i, sep = ""), "X")} else {assign(paste("c", i, sep = ""), " ")}
}
```


\begin{center}
\begin{tabular}{|l|l|l|l|l|}
\hline
\multicolumn{5}{|c|}{\textbf{`r t1[8,3]`}} \tabularnewline
\hline
`r t1[8,4]` & Schmutzwasser & Baustoffe & Energie & Fläche \\
\hline
[`r as.character(c8)`] Klimaregulation & [`r as.character(c8)`] Regenwasser & [`r as.character(c8)`] Regenwasser & [`r as.character(c8)`] Regenwasser & [`r as.character(c8)`] Regenwasser \\
\hline
[`r as.character(c9)`] Wasserregulation & [`r as.character(c9)`] Schmutzwasser & [`r as.character(c9)`] Schmutzwasser & [`r as.character(c9)`] Schmutzwasser & [`r as.character(c9)`] Schmutzwasser \\
\hline
[`r as.character(c10)`] Wasserreinigung & [`r as.character(c10)`] Baustoffe & [`r as.character(c10)`] Baustoffe & [`r as.character(c10)`] Baustoffe & [`r as.character(c10)`] Baustoffe \\
\hline
[`r as.character(c11)`] Erhaltung biol. Vielfalt & [`r as.character(c11)`] Energie & [`r as.character(c11)`] Energie & [`r as.character(c11)`] Energie & [`r as.character(c11)`] Energie \\
\hline
\end{tabular}
\end{center}

```{r , echo=FALSE}
for(i in 12:15){
  if(t1[i,6] == "Ja") {assign(paste("c", i, sep = ""), "X")} else {assign(paste("c", i, sep = ""), " ")}
}
```

\begin{center}
\begin{tabularx}{\textwidth}{|X|X|X|}
\hline
\multicolumn{3}{|c|}{\textbf{`r t1[12,3]`}} \tabularnewline
\hline
[`r as.character(c12)`] Gebäudeebene & [`r as.character(c13)`] Grundstückebene & [`r as.character(c14)`] Quartiersebene \\
\hline
\multicolumn{3}{|c|}{\textbf{Hinweis:} `r t1[15,6]`} \\
\hline
\end{tabularx}
\end{center}


```{r , echo=FALSE}
for(i in 16:18){
  if(t1[i,6] == "Ja") {assign(paste("c", i, sep = ""), "X")} else {assign(paste("c", i, sep = ""), " ")}
}
```

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\multicolumn{3}{|c|}{\textbf{`r t1[16,2]`}} \tabularnewline
\hline
[`r as.character(c16)`] geringer Bedarf & [`r as.character(c17)`] mittlerer Bedarf & [`r as.character(c18)`] hoher Bedarf \\
\hline
\multicolumn{3}{|c|}{`r t1[19,6]`   `r t1[19,4]`} \\
\hline
\end{tabular}
\end{center}

```{r , echo=FALSE}
for(i in 20:22){
  if(t1[i,6] == "Ja") {assign(paste("c", i, sep = ""), "X")} else {assign(paste("c", i, sep = ""), " ")}
}
```

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
\multicolumn{6}{|c|}{\textbf{`r t1[20,3]`}} \tabularnewline
\hline
`r t1[20,4]` & `r t1[20,6]`  &`r t1[21,4]` & `r t1[21,6]`  & `r t1[22,4]` & `r t1[22,6]` \\
\hline
\multicolumn{6}{|c|}{\textbf{Hinweis:} `r t1[23,6]`} \\
\hline
\end{tabular}
\end{center}

```{r , echo=FALSE}
for(i in 24:26){
  if(t1[i,6] == "Ja") {assign(paste("c", i, sep = ""), "X")} else {assign(paste("c", i, sep = ""), " ")}
}
```

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\multicolumn{3}{|c|}{\textbf{`r t1[24,3]`}} \\
\hline
[`r as.character(c24)`]`r t1[24,4]` & [`r as.character(c25)`] `r t1[25,4]`  & [`r as.character(c26)`] `r t1[26,4]` \\
\hline
\multicolumn{3}{|c|}{\textbf{Hinweis:} `r t1[27,6]`} \\
\hline
\end{tabular}
\end{center}

## *Detailinformationen*

### *Funktionsbeschreibung & Aufbau*

`r t1[28,5]`

### *Systemskizze*

```{r , fig.width = 8 , fig.height = 3 , echo=FALSE, message=FALSE, warning=FALSE}
library(png)
library(grid)
library(gridExtra)
#j <- rasterGrob(as.raster(readPNG(as.character(t1[51,6]))), interpolate = FALSE)
#grid.arrange(jj, jj, ncol = 2)
```

### Planung, Bemessung und rechtliche Aspekte

`r t1[30,6]`

### Aufwand

`r t1[31,6]`

### Weitergehende Hinweise

`r t1[32,6]`

### Ressourcenübergreifende Aspekte

\begin{center}
\begin{tabularx}{\textwidth}{|X|X|}
\hline
\multicolumn{1}{|c|}{\textbf{Ressource}} & \multicolumn{1}{|c|}{\textbf{Angaben}} \tabularnewline
\hline
\multicolumn{2}{|c|}{ \textbf{SYNERGIEN} } \tabularnewline
\hline
Regenwasser & `r t1[33,6]`\\
\hline
Schmutzwasser & `r t1[34,6]`\\
\hline
Baustoffe & `r t1[35,6]`\\
\hline
Energie & `r t1[36,6]`\\
\hline
Fläche & `r t1[37,6]`\\
\hline
Ökobilanz & `r t1[38,6]`\\
\hline
\multicolumn{2}{|c|}{ \textbf{ZIELKONFLIKTE} } \\
\hline
Regenwasser & `r t1[39,6]`\\
\hline
Schmutzwasser & `r t1[40,6]`\\
\hline
Baustoffe & `r t1[41,6]`\\
\hline
Energie & `r t1[42,6]`\\
\hline
Fläche & `r t1[43,6]`\\
\hline
Ökobilanz & `r t1[44,6]`\\
\hline
\end{tabularx}
\end{center}


\begin{center}
\begin{tabularx}{\textwidth}{|X|X|}
\hline
\multicolumn{1}{|c|}{\textbf{Vorteile}} & \multicolumn{1}{|c|}{\textbf{Nachteile}} \tabularnewline
\hline
`r t1[45,6]` & `r t1[50,6]`\\
\hline
`r t1[46,6]` & `r t1[51,6]`\\
\hline
`r t1[47,6]` & `r t1[52,6]`\\
\hline
`r t1[48,6]` & `r t1[53,6]`\\
\hline
`r t1[49,6]` & `r t1[54,6]`\\
\hline
\end{tabularx}
\end{center}

### Umsetzungsbeispiele

`r t1[55,6]`

### Literatur

`r t1[56,6]`
